import pandas as pd
import pytest

import src.model as model


# kmeans model
def test_kmeans_model_happy():
    df_in_values = [['pomanders', 79893, 60, 10, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                     0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                     0, 0, 0, 0, 0, 0, 0, 343.3, 26.0, 55.0, 8.0, 12.0, 23.0, 23.0],
                    ['green eggs and ham breakfast pizza', 214799, 35, 10, 6, 0, 0, 1,
                     0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0,
                     0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 172.6, 7.0, 7.0,
                     16.0, 20.0, 10.0, 6.0],
                    ['frozen fruit salad dessert', 350764, 240, 9, 7, 0, 0, 0, 0, 0,
                     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                     1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 203.0, 13.0, 103.0, 3.0,
                     3.0, 25.0, 10.0],
                    ['texas jalapeno potato salad', 305507, 60, 5, 10, 1, 1, 0, 0, 1,
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0,
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 263.2, 19.0, 15.0, 18.0,
                     12.0, 11.0, 10.0],
                    ['no bake bird seed cookies', 260459, 20, 5, 7, 0, 0, 0, 0, 0, 1,
                     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1,
                     0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 103.2, 9.0, 18.0, 1.0, 6.0,
                     4.0, 3.0],
                    ['italian muffuletta', 455325, 10, 6, 10, 0, 1, 1, 0, 0, 0, 0, 0,
                     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
                     0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 396.7, 30.0, 12.0, 49.0, 42.0,
                     38.0, 10.0],
                    ['balsamic olive oil bread dip', 20260, 15, 8, 8, 1, 1, 0, 1, 0,
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0,
                     0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 51.0, 8.0, 2.0, 0.0, 0.0,
                     3.0, 0.0],
                    ['health nut  oatmeal', 416171, 30, 6, 8, 0, 0, 0, 0, 0, 0, 0, 0,
                     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                     1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 272.0, 13.0, 69.0, 7.0, 19.0, 7.0,
                     13.0],
                    ['beef and brie triple layer sandwich', 158561, 11, 12, 8, 1, 0,
                     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
                     1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 454.1, 29.0,
                     60.0, 20.0, 55.0, 22.0, 15.0],
                    ['chilean butternut squash casserole', 82191, 65, 15, 13, 1, 1, 1,
                     1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0,
                     1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 334.3, 22.0, 24.0,
                     21.0, 30.0, 35.0, 14.0]]
    df_in_columns = ['name', 'id', 'minutes', 'n_steps', 'n_ingredients', 'pepper', 'onion',
                     'cheese', 'garlic', 'egg', 'butter', 'flour', 'lemon', 'chicken',
                     'milk', 'tomato', 'cream', 'baking', 'vanilla', 'cinnamon', 'parsley',
                     'apple', 'beef', 'potato', 'chili', 'dietary', 'easy',
                     'low-in-something', 'main-dish', 'meat', 'vegetables', 'north-american',
                     'desserts', 'healthy', 'dinner-party', 'vegetarian', 'beginner-cook',
                     'inexpensive', 'fruit', 'oven', 'eggs-dairy', 'pasta-rice-and-grains',
                     'kid-friendly', 'comfort-food', 'european', 'calories', 'total_fat',
                     'sugar', 'sodium', 'protein', 'saturated_fat', 'carbs']
    df_in_index = list(range(0, 10))

    df_in = pd.DataFrame(df_in_values, columns=df_in_columns, index=df_in_index)

    df_true = pd.DataFrame(
        [['pomanders', 79893, 0.0831414934994812, 0.4509096384805817,
          -1.7498373590829115, -0.8164965809277261, -0.8164965809277261,
          -0.8164965809277261, -0.49999999999999994, -0.6546536707079771,
          -0.49999999999999994, 0.0, 0.0, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, 2.9999999999999996, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0, 1.5275252316519463,
          0.0, -0.49999999999999994, -0.5, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, -0.8164965809277261,
          0.0, -0.49999999999999994, -0.6546536707079772,
          -0.3333333333333333, -0.6546536707079771, -0.49999999999999994,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          0.6898534412176449, 1.0065837264687565, 0.5851823144009037,
          -0.4570380104114939, -0.47019644844582864, 0.4342995181076895,
          2.0375656161624254, 0],
         ['green eggs and ham breakfast pizza', 214799,
          -0.30177282825737634, 0.4509096384805817, -0.8962581595302717,
          -0.8164965809277261, -0.8164965809277261, 1.2247448713915892,
          -0.49999999999999994, 1.5275252316519463, -0.49999999999999994,
          0.0, 0.0, 0.0, 1.9999999999999998, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          0.6546536707079773, 1.0, -0.6546536707079771, 0.0,
          -0.49999999999999994, -0.5, 0.0, -0.49999999999999994,
          2.9999999999999996, -0.49999999999999994, -0.8164965809277261,
          0.0, 1.9999999999999998, -0.6546536707079772,
          -0.3333333333333333, 1.5275252316519463, -0.49999999999999994,
          1.9999999999999998, -0.3333333333333333, -0.49999999999999994,
          -0.7126951821250425, -1.2702127976867645, -0.9331285553960357,
          0.12332771709516495, 0.0059518537777953845, -0.6514492771615344,
          -0.7115308500884661, 0],
         ['frozen fruit salad dessert', 350764, 2.8545246101488555,
          0.12883132528016628, -0.46946855975395174, -0.8164965809277261,
          -0.8164965809277261, -0.8164965809277261, -0.49999999999999994,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, 2.9999999999999996,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          2.9999999999999996, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, -1.5275252316519468, -1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          1.9999999999999998, -0.3333333333333333, -0.49999999999999994,
          -0.8164965809277261, 0.0, -0.49999999999999994,
          1.5275252316519468, -0.3333333333333333, -0.6546536707079771,
          -0.49999999999999994, -0.49999999999999994, -0.3333333333333333,
          -0.49999999999999994, -0.4629149937851614, -0.5512244216376526,
          2.103493184197843, -0.8197665901031557, -1.0058632884474057,
          0.6013377943029548, -0.06468462273531515, 0],
         ['texas jalapeno potato salad', 305507, 0.0831414934994812,
          -1.1594819275214954, 0.810900239575008, 1.2247448713915892,
          1.2247448713915892, -0.8164965809277261, -0.49999999999999994,
          1.5275252316519463, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, 2.9999999999999996,
          -0.3333333333333333, 0.6546536707079773, -1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          -0.8164965809277261, 0.0, -0.49999999999999994,
          -0.6546536707079772, -0.3333333333333333, -0.6546536707079771,
          -0.49999999999999994, -0.49999999999999994, -0.3333333333333333,
          -0.49999999999999994, 0.031715510756313486, 0.16776395441145928,
          -0.6800767437632125, 0.26841914897182967, -0.47019644844582864,
          -0.5679301390639019, -0.06468462273531515, 0],
         ['no bake bird seed cookies', 260459, -0.5327214213114908,
          -1.1594819275214954, -0.46946855975395174, -0.8164965809277261,
          -0.8164965809277261, -0.8164965809277261, -0.49999999999999994,
          -0.6546536707079771, 1.9999999999999998, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, 2.9999999999999996, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0, 1.5275252316519463,
          0.0, -0.49999999999999994, -0.5, 0.0, 1.9999999999999998,
          -0.3333333333333333, 1.9999999999999998, 1.2247448713915892, 0.0,
          -0.49999999999999994, 1.5275252316519468, -0.3333333333333333,
          -0.6546536707079771, 1.9999999999999998, 1.9999999999999998,
          -0.3333333333333333, -0.49999999999999994, -1.2829170594535866,
          -1.030550005670394, -0.5851823144009037, -0.9648580219798203,
          -0.8273076751135466, -1.1525641057473301, -1.1966655206033292, 0],
         ['italian muffuletta', 455325, -0.6866871500142339,
          -0.8374036143210799, 0.810900239575008, -0.8164965809277261,
          1.2247448713915892, 1.2247448713915892, -0.49999999999999994,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, 2.9999999999999996, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, -1.5275252316519468, -1.0,
          -0.6546536707079771, 0.0, 1.9999999999999998, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          -0.8164965809277261, 0.0, -0.49999999999999994,
          -0.6546536707079772, -0.3333333333333333, 1.5275252316519463,
          -0.49999999999999994, -0.49999999999999994, 2.9999999999999996,
          1.9999999999999998, 1.1286120615251989, 1.4859093105014978,
          -0.7749711731255212, 2.517336343060133, 1.3153596848927613,
          1.6870865895721787, -0.06468462273531515, 1],
         ['balsamic olive oil bread dip', 20260, -0.6097042856628624,
          -0.19324698792024914, -0.04267895997763184, 1.2247448713915892,
          1.2247448713915892, -0.8164965809277261, 1.9999999999999998,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, 1.9999999999999998,
          1.2247448713915892, 0.0, -0.49999999999999994,
          -0.6546536707079772, -0.3333333333333333, -0.6546536707079771,
          -0.49999999999999994, -0.49999999999999994, -0.3333333333333333,
          1.9999999999999998, -1.7118159354845666, -1.1503814016785792,
          -1.0912859376665502, -1.0374037379181527, -1.1844189017812647,
          -1.2360832438449627, -1.6818001911181923, 0],
         ['health nut  oatmeal', 416171, -0.37875569260874786,
          -0.8374036143210799, -0.04267895997763184, -0.8164965809277261,
          -0.8164965809277261, -0.8164965809277261, -0.49999999999999994,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          1.9999999999999998, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          1.2247448713915892, 0.0, -0.49999999999999994,
          1.5275252316519468, -0.3333333333333333, -0.6546536707079771,
          1.9999999999999998, -0.49999999999999994, -0.3333333333333333,
          -0.49999999999999994, 0.1040203021178581, -0.5512244216376526,
          1.0280229847583444, -0.5295837263498262, -0.05356668400015761,
          -0.9020066914544322, 0.42045004777954803, 0],
         ['beef and brie triple layer sandwich', 158561,
          -0.6712905771439596, 1.0950662648814125, -0.04267895997763184,
          1.2247448713915892, -0.8164965809277261, 1.2247448713915892,
          -0.49999999999999994, -0.6546536707079771, -0.49999999999999994,
          0.0, 0.0, 0.0, -0.49999999999999994, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          2.9999999999999996, -0.3333333333333333, -0.3333333333333333,
          -1.5275252316519468, -1.0, -0.6546536707079771, 0.0,
          1.9999999999999998, 2.0, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, -0.8164965809277261,
          0.0, -0.49999999999999994, -0.6546536707079772,
          -0.3333333333333333, -0.6546536707079771, -0.49999999999999994,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          1.600236496088001, 1.3660779144933124, 0.7433396966714183,
          0.41351058084849435, 2.0891006760061503, 0.3507803800100569,
          0.7438731614561235, 1],
         ['chilean butternut squash casserole', 82191, 0.16012435785085272,
          2.0613012044826586, 2.0912690389039676, 1.2247448713915892,
          1.2247448713915892, 1.2247448713915892, 1.9999999999999998,
          1.5275252316519463, 1.9999999999999998, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          2.9999999999999996, 0.6546536707079773, -1.0, 1.5275252316519463,
          0.0, -0.49999999999999994, 2.0, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, 1.2247448713915892,
          0.0, 1.9999999999999998, -0.6546536707079772, 2.9999999999999996,
          1.5275252316519463, -0.49999999999999994, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, 0.6159053591433381,
          0.5272581424360152, -0.3953934556762863, 0.4860562967868267,
          0.6011372315573253, 1.4365291752792808, 0.5821616046178357, 1]],
        columns=['name', 'id', 'minutes', 'n_steps', 'n_ingredients', 'pepper', 'onion',
                 'cheese', 'garlic', 'egg', 'butter', 'flour', 'lemon', 'chicken',
                 'milk', 'tomato', 'cream', 'baking', 'vanilla', 'cinnamon', 'parsley',
                 'apple', 'beef', 'potato', 'chili', 'dietary', 'easy',
                 'low-in-something', 'main-dish', 'meat', 'vegetables', 'north-american',
                 'desserts', 'healthy', 'dinner-party', 'vegetarian', 'beginner-cook',
                 'inexpensive', 'fruit', 'oven', 'eggs-dairy', 'pasta-rice-and-grains',
                 'kid-friendly', 'comfort-food', 'european', 'calories', 'total_fat',
                 'sugar', 'sodium', 'protein', 'saturated_fat', 'carbs', 'cluster'], index=list(range(0, 10)))
    df_true['cluster'] = df_true['cluster'].astype('int32')

    # Compute test output
    droplist = ['id', 'name']
    df_test = model.kmeans_model(df_in, droplist=droplist, clust_col='cluster', n_cluster=2, seed=423)
    pd.testing.assert_frame_equal(df_test, df_true)


def test_kmeans_model_unhappy():
    df_in = 'I am not a dataframe'

    with pytest.raises(AttributeError):
        droplist = ['id', 'name']
        model.kmeans_model(df_in, droplist=droplist, clust_col='cluster', n_cluster=2, seed=423)


def test_recommend_happy():
    df_in = pd.DataFrame(
        [['pomanders', 79893, 0.0831414934994812, 0.4509096384805817,
          -1.7498373590829115, -0.8164965809277261, -0.8164965809277261,
          -0.8164965809277261, -0.49999999999999994, -0.6546536707079771,
          -0.49999999999999994, 0.0, 0.0, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, 2.9999999999999996, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0, 1.5275252316519463,
          0.0, -0.49999999999999994, -0.5, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, -0.8164965809277261,
          0.0, -0.49999999999999994, -0.6546536707079772,
          -0.3333333333333333, -0.6546536707079771, -0.49999999999999994,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          0.6898534412176449, 1.0065837264687565, 0.5851823144009037,
          -0.4570380104114939, -0.47019644844582864, 0.4342995181076895,
          2.0375656161624254, 0],
         ['green eggs and ham breakfast pizza', 214799,
          -0.30177282825737634, 0.4509096384805817, -0.8962581595302717,
          -0.8164965809277261, -0.8164965809277261, 1.2247448713915892,
          -0.49999999999999994, 1.5275252316519463, -0.49999999999999994,
          0.0, 0.0, 0.0, 1.9999999999999998, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          0.6546536707079773, 1.0, -0.6546536707079771, 0.0,
          -0.49999999999999994, -0.5, 0.0, -0.49999999999999994,
          2.9999999999999996, -0.49999999999999994, -0.8164965809277261,
          0.0, 1.9999999999999998, -0.6546536707079772,
          -0.3333333333333333, 1.5275252316519463, -0.49999999999999994,
          1.9999999999999998, -0.3333333333333333, -0.49999999999999994,
          -0.7126951821250425, -1.2702127976867645, -0.9331285553960357,
          0.12332771709516495, 0.0059518537777953845, -0.6514492771615344,
          -0.7115308500884661, 0],
         ['frozen fruit salad dessert', 350764, 2.8545246101488555,
          0.12883132528016628, -0.46946855975395174, -0.8164965809277261,
          -0.8164965809277261, -0.8164965809277261, -0.49999999999999994,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, 2.9999999999999996,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          2.9999999999999996, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, -1.5275252316519468, -1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          1.9999999999999998, -0.3333333333333333, -0.49999999999999994,
          -0.8164965809277261, 0.0, -0.49999999999999994,
          1.5275252316519468, -0.3333333333333333, -0.6546536707079771,
          -0.49999999999999994, -0.49999999999999994, -0.3333333333333333,
          -0.49999999999999994, -0.4629149937851614, -0.5512244216376526,
          2.103493184197843, -0.8197665901031557, -1.0058632884474057,
          0.6013377943029548, -0.06468462273531515, 0],
         ['texas jalapeno potato salad', 305507, 0.0831414934994812,
          -1.1594819275214954, 0.810900239575008, 1.2247448713915892,
          1.2247448713915892, -0.8164965809277261, -0.49999999999999994,
          1.5275252316519463, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, 2.9999999999999996,
          -0.3333333333333333, 0.6546536707079773, -1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          -0.8164965809277261, 0.0, -0.49999999999999994,
          -0.6546536707079772, -0.3333333333333333, -0.6546536707079771,
          -0.49999999999999994, -0.49999999999999994, -0.3333333333333333,
          -0.49999999999999994, 0.031715510756313486, 0.16776395441145928,
          -0.6800767437632125, 0.26841914897182967, -0.47019644844582864,
          -0.5679301390639019, -0.06468462273531515, 0],
         ['no bake bird seed cookies', 260459, -0.5327214213114908,
          -1.1594819275214954, -0.46946855975395174, -0.8164965809277261,
          -0.8164965809277261, -0.8164965809277261, -0.49999999999999994,
          -0.6546536707079771, 1.9999999999999998, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, 2.9999999999999996, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0, 1.5275252316519463,
          0.0, -0.49999999999999994, -0.5, 0.0, 1.9999999999999998,
          -0.3333333333333333, 1.9999999999999998, 1.2247448713915892, 0.0,
          -0.49999999999999994, 1.5275252316519468, -0.3333333333333333,
          -0.6546536707079771, 1.9999999999999998, 1.9999999999999998,
          -0.3333333333333333, -0.49999999999999994, -1.2829170594535866,
          -1.030550005670394, -0.5851823144009037, -0.9648580219798203,
          -0.8273076751135466, -1.1525641057473301, -1.1966655206033292, 0],
         ['italian muffuletta', 455325, -0.6866871500142339,
          -0.8374036143210799, 0.810900239575008, -0.8164965809277261,
          1.2247448713915892, 1.2247448713915892, -0.49999999999999994,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, 2.9999999999999996, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, -1.5275252316519468, -1.0,
          -0.6546536707079771, 0.0, 1.9999999999999998, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          -0.8164965809277261, 0.0, -0.49999999999999994,
          -0.6546536707079772, -0.3333333333333333, 1.5275252316519463,
          -0.49999999999999994, -0.49999999999999994, 2.9999999999999996,
          1.9999999999999998, 1.1286120615251989, 1.4859093105014978,
          -0.7749711731255212, 2.517336343060133, 1.3153596848927613,
          1.6870865895721787, -0.06468462273531515, 1],
         ['balsamic olive oil bread dip', 20260, -0.6097042856628624,
          -0.19324698792024914, -0.04267895997763184, 1.2247448713915892,
          1.2247448713915892, -0.8164965809277261, 1.9999999999999998,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, 1.9999999999999998,
          1.2247448713915892, 0.0, -0.49999999999999994,
          -0.6546536707079772, -0.3333333333333333, -0.6546536707079771,
          -0.49999999999999994, -0.49999999999999994, -0.3333333333333333,
          1.9999999999999998, -1.7118159354845666, -1.1503814016785792,
          -1.0912859376665502, -1.0374037379181527, -1.1844189017812647,
          -1.2360832438449627, -1.6818001911181923, 0],
         ['health nut  oatmeal', 416171, -0.37875569260874786,
          -0.8374036143210799, -0.04267895997763184, -0.8164965809277261,
          -0.8164965809277261, -0.8164965809277261, -0.49999999999999994,
          -0.6546536707079771, -0.49999999999999994, 0.0, 0.0, 0.0,
          1.9999999999999998, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          -0.3333333333333333, 0.6546536707079773, 1.0,
          -0.6546536707079771, 0.0, -0.49999999999999994, -0.5, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          1.2247448713915892, 0.0, -0.49999999999999994,
          1.5275252316519468, -0.3333333333333333, -0.6546536707079771,
          1.9999999999999998, -0.49999999999999994, -0.3333333333333333,
          -0.49999999999999994, 0.1040203021178581, -0.5512244216376526,
          1.0280229847583444, -0.5295837263498262, -0.05356668400015761,
          -0.9020066914544322, 0.42045004777954803, 0],
         ['beef and brie triple layer sandwich', 158561,
          -0.6712905771439596, 1.0950662648814125, -0.04267895997763184,
          1.2247448713915892, -0.8164965809277261, 1.2247448713915892,
          -0.49999999999999994, -0.6546536707079771, -0.49999999999999994,
          0.0, 0.0, 0.0, -0.49999999999999994, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          -0.3333333333333333, 0.0, -0.3333333333333333,
          2.9999999999999996, -0.3333333333333333, -0.3333333333333333,
          -1.5275252316519468, -1.0, -0.6546536707079771, 0.0,
          1.9999999999999998, 2.0, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, -0.8164965809277261,
          0.0, -0.49999999999999994, -0.6546536707079772,
          -0.3333333333333333, -0.6546536707079771, -0.49999999999999994,
          -0.49999999999999994, -0.3333333333333333, -0.49999999999999994,
          1.600236496088001, 1.3660779144933124, 0.7433396966714183,
          0.41351058084849435, 2.0891006760061503, 0.3507803800100569,
          0.7438731614561235, 1],
         ['chilean butternut squash casserole', 82191, 0.16012435785085272,
          2.0613012044826586, 2.0912690389039676, 1.2247448713915892,
          1.2247448713915892, 1.2247448713915892, 1.9999999999999998,
          1.5275252316519463, 1.9999999999999998, 0.0, 0.0, 0.0,
          -0.49999999999999994, -0.3333333333333333, -0.3333333333333333,
          0.0, -0.3333333333333333, -0.3333333333333333, 0.0,
          -0.3333333333333333, -0.3333333333333333, -0.3333333333333333,
          2.9999999999999996, 0.6546536707079773, -1.0, 1.5275252316519463,
          0.0, -0.49999999999999994, 2.0, 0.0, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, 1.2247448713915892,
          0.0, 1.9999999999999998, -0.6546536707079772, 2.9999999999999996,
          1.5275252316519463, -0.49999999999999994, -0.49999999999999994,
          -0.3333333333333333, -0.49999999999999994, 0.6159053591433381,
          0.5272581424360152, -0.3953934556762863, 0.4860562967868267,
          0.6011372315573253, 1.4365291752792808, 0.5821616046178357, 1]],
        columns=['name', 'id', 'minutes', 'n_steps', 'n_ingredients', 'pepper', 'onion',
                 'cheese', 'garlic', 'egg', 'butter', 'flour', 'lemon', 'chicken',
                 'milk', 'tomato', 'cream', 'baking', 'vanilla', 'cinnamon', 'parsley',
                 'apple', 'beef', 'potato', 'chili', 'dietary', 'easy',
                 'low-in-something', 'main-dish', 'meat', 'vegetables', 'north-american',
                 'desserts', 'healthy', 'dinner-party', 'vegetarian', 'beginner-cook',
                 'inexpensive', 'fruit', 'oven', 'eggs-dairy', 'pasta-rice-and-grains',
                 'kid-friendly', 'comfort-food', 'european', 'calories', 'total_fat',
                 'sugar', 'sodium', 'protein', 'saturated_fat', 'carbs', 'cluster'], index=list(range(0, 10)))
    df_in['cluster'] = df_in['cluster'].astype('int32')

    index_true = [416171, 260459, 79893]
    name_true = ['health nut  oatmeal', 'no bake bird seed cookies', 'pomanders']

    # Compute test output
    index_test, name_test = model.recommend(df_in, idx=416171, top_n=3)
    assert (index_test == index_true)&(name_test == name_true)


def test_recommend_unhappy():
    df_in = 'I am not a dataframe'

    with pytest.raises(TypeError):
        model.recommend(df_in, idx=416171, top_n=3)